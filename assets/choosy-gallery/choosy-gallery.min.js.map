{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 5641ffe4fd9c07e8fe24","webpack:///./src/choosy-gallery.js"],"names":["$","jQuery","desiredHeight","element","desired","data","isNaN","Row","elements","width","map","idx","e","height","get","aspects","reduce","a","b","Partition","rows","other","concat","row","rowError","errors","Math","pow","Partitioner","gallery","targetWidth","selector","cache","OptimalPartitioner","signature","outerHTML","length","first","best","i","left","solve","slice","right","candidate","score","PrettyGoodPartitioner","half","floor","Gallery","options","Object","assign","renderFrequency","debug","children","append","find","css","document","ready","after","unmount","setTimeout","render","mount","window","on","abs","lastRenderWidth","partitioner","solution","widths","each","index","err","round","attr","text","undefined","fn","choosyGallery"],"mappings":"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","file":"choosy-gallery.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"choosyGallery\"] = factory();\n\telse\n\t\troot[\"choosyGallery\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5641ffe4fd9c07e8fe24","const $ = jQuery;\n\nfunction desiredHeight (element) {\n  const desired = $(element).data('desired-height');\n\n  if (!isNaN(desired)) {\n    return desired;\n  } else {\n    return 300;\n  }\n}\n\nclass Row {\n  constructor (elements, width) {\n    this.elements = elements;\n    this.width = width;\n\n    //this.freeze();\n  }\n\n  aspects () {\n    return this.elements.map((idx, e) => $(e).width() / $(e).height()).get();\n  }\n\n  height () {\n    return this.width / this.aspects().reduce((a, b) => a + b);\n  }\n\n  widths () {\n    return this.aspects().map((a) => (a * this.height() / this.width * 100) + '%');\n  }\n}\n\n\nclass Partition {\n  constructor (...rows) {\n    this.rows = rows;\n  }\n\n  concat (other) {\n    return new Partition(...this.rows.concat(other.rows));\n  }\n\n  errors () {\n    return this.rows.map((row) => {\n      let rowError = row.elements.map((idx, e) => { return desiredHeight(e) - row.height(); }).get();\n      return rowError;\n    }).reduce((a, b) => a.concat(b));\n  }\n\n  score () {\n    // lower is better\n    return this.errors().map((e) => Math.pow(e, 2)).reduce((a, b) => a + b);\n  }\n}\n\nclass Partitioner {\n  constructor (gallery) {\n    this.targetWidth = gallery.selector.width();\n    this.cache = {};\n  }\n}\n\n\nclass OptimalPartitioner extends Partitioner {\n  solve (elements) {\n    let signature = elements.map((idx, e) => e.outerHTML).get();\n\n    if (!this.cache[signature]) {\n      if (elements.length == 1) {\n        // base case: only one element\n        let element = elements.first();\n        this.cache[signature] = new Partition(new Row(element, this.targetWidth));\n      } else {\n\n        let best = new Partition(new Row(elements, this.targetWidth));\n\n        for (let i = 1; i < elements.length; ++i) {\n\n          let left = this.solve(elements.slice(0, i));\n          let right = this.solve(elements.slice(i));\n\n          let candidate = left.concat(right);\n\n          if (candidate.score() < best.score()) {\n            best = candidate;\n          }\n        }\n\n        this.cache[signature] = best;\n      }\n    }\n\n    return this.cache[signature];\n  }\n}\n\nclass PrettyGoodPartitioner extends Partitioner {\n  solve (elements) {\n    let signature = elements.map((idx, e) => e.outerHTML).get();\n\n    if (!this.cache[signature]) {\n      if (elements.length == 1) {\n        // base case: only one element\n        let element = elements.first();\n        this.cache[signature] = new Partition(new Row(element, this.targetWidth));\n      } else if (elements.length < 8) {\n\n        let best = new Partition(new Row(elements, this.targetWidth));\n\n        for (let i = 1; i < elements.length; ++i) {\n\n          let left = this.solve(elements.slice(0, i));\n          let right = this.solve(elements.slice(i));\n\n          let candidate = left.concat(right);\n\n          if (candidate.score() < best.score()) {\n            best = candidate;\n          }\n        }\n\n        this.cache[signature] = best;\n      } else {\n        let half = Math.floor(elements.length / 2);\n\n        let left = this.solve(elements.slice(0, half));\n        let right = this.solve(elements.slice(half));\n\n        this.cache[signature] = left.concat(right);\n      }\n    }\n\n    return this.cache[signature];\n  }\n}\n\nclass Gallery {\n  constructor (element, options = {}) {\n    this.options = Object.assign({\n      renderFrequency: 50, // re-render every 10 pixels\n      debug: false,\n    }, options);\n\n    this.selector = $(element);\n\n    if (this.options.debug) {\n      $(element).children().append(\"<div class='debug'>PHOOEY</div>\");\n      $(element).find('.debug')\n        .css('font-size', '20px')\n        .css('position', 'absolute')\n        .css('top', '60%')\n        .css('left', '50%')\n        .css('transform', 'translateX(-50%)');\n    }\n\n    $(document).ready(() => {\n      // as soon as the DOM is ready, hide the gallery. this prevents images\n      // from showing on the screen before we've had time to set their sizes\n      $(element).after(\"<div class='loading' style='display:block;'></div>\");\n      this.unmount();\n\n      setTimeout(() => {\n        // in case onload never fires, set a timer to mount the component.\n        // FIXME this is a hack; ideally we'd detect whether images were loaded\n        // some other way.\n        this.render();\n        this.mount();\n      }, 2000);\n    });\n\n    $(window).on('load', () => {\n      // once the window (including all resources) has loaded, we'll be able\n      // to query the dimensions of each image, so we can begin rendering.\n      this.render();\n      // once the render is complete, unhide the gallery.\n      this.mount();\n    });\n\n    $(window).on('resize', () => {\n      // when the window is resized, check if the current gallery size differs\n      // from the size at last render time by at least the configured render\n      // frequency.\n      if (Math.abs(this.selector.width() - this.lastRenderWidth) > this.options.renderFrequency) {\n        // if it does, re-render the gallery.\n        this.render();\n      }\n    });\n  }\n\n  unmount () {\n    // make the gallery invisible, but keep it in the document flow so its\n    // width doesn't change.\n    this.selector.css('visibility', 'hidden');\n    this.selector.css('height', 0);\n    $('.loading')\n      .css('display','block');\n  }\n\n  mount () {\n    // make the gallery visible again\n    this.selector.css('visibility', 'visible');\n    this.selector.css('height', 'auto');\n    $('.loading')\n      .css('display','none');\n  }\n\n  render () {\n    // get the width of the container; this works even when gallery is\n    // unmounted because we don't remove it from the document flow\n    var targetWidth = this.selector.width();\n\n    // fetch the items from the gallery\n    var elements = this.selector.children();\n\n    if (elements.length == 0) {\n      // if there are no items in the gallery, no need to render\n      return;\n    }\n\n    let partitioner = new PrettyGoodPartitioner(this);\n    let solution = partitioner.solve(elements);\n\n    var gallery = this;\n\n    var widths = solution.rows.map((row) => row.widths()).reduce((a, b) => a.concat(b));\n    var errors = solution.errors();\n\n    elements.each(function (index) {\n      // and apply that partition's dictated percent-widths to each element\n      $(this).width(widths[index]);\n      $(this).height('auto');\n\n      if (gallery.options.debug) {\n        // add title text to each item in the gallery indicating whether it\n        // wants to be bigger or smaller than it ended up, and by how much.\n        var err = Math.round(errors[index]);\n\n        if (err > 20) {\n          $(this).attr('title', 'wants to be ' + err + ' px bigger');\n          $(this).find('.debug').text('+' + err).css('color', 'green').css('font-size', (12 + err / 6) + 'px');\n\n        } else if (err < -20) {\n          $(this).attr('title', 'wants to be ' + Math.abs(err) + ' px smaller');\n          $(this).find('.debug').text(err).css('color', 'red').css('font-size', (12 + Math.abs(err) / 6) + 'px');\n        } else {\n          $(this).attr('title', 'wow, just about the right size! (' + err + ')');\n\n          $(this).find('.debug').text('--');\n        }\n\n      }\n    });\n\n    this.lastRenderWidth = targetWidth;\n  }\n}\n\nif (typeof jQuery !== undefined) {\n  jQuery.fn.choosyGallery = function (options) {\n    return this.each(function () {\n      // $(selector).data('gallery') can be used to access the Gallery instance,\n      // which may be useful e.g. for forcing it to render() after modification.\n      $(this).data('gallery', new Gallery(this, options));\n    });\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/choosy-gallery.js"],"sourceRoot":""}